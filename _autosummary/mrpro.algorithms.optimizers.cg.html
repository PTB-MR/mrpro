

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mrpro.algorithms.optimizers.cg &mdash; mrpro</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=16f952a1" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mrpro.algorithms.optimizers.lbfgs" href="mrpro.algorithms.optimizers.lbfgs.html" />
    <link rel="prev" title="mrpro.algorithms.optimizers.adam" href="mrpro.algorithms.optimizers.adam.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            mrpro
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#mrpro-algorithms">MRpro Algorithms</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="mrpro.algorithms.html">mrpro.algorithms</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mrpro.algorithms.prewhiten_kspace.html">mrpro.algorithms.prewhiten_kspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="mrpro.algorithms.csm.html">mrpro.algorithms.csm</a></li>
<li class="toctree-l4"><a class="reference internal" href="mrpro.algorithms.dcf.html">mrpro.algorithms.dcf</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="mrpro.algorithms.optimizers.html">mrpro.algorithms.optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="mrpro.algorithms.reconstruction.html">mrpro.algorithms.reconstruction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#mrpro-data">MRpro Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#mrpro-operators">MRpro Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#mrpro-phantoms">MRpro Phantoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#mrpro-utilities">MRpro Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor_guide.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mrpro</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
          <li class="breadcrumb-item"><a href="mrpro.algorithms.html">mrpro.algorithms</a></li>
          <li class="breadcrumb-item"><a href="mrpro.algorithms.optimizers.html">mrpro.algorithms.optimizers</a></li>
      <li class="breadcrumb-item active">mrpro.algorithms.optimizers.cg</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/mrpro.algorithms.optimizers.cg.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mrpro-algorithms-optimizers-cg">
<h1>mrpro.algorithms.optimizers.cg<a class="headerlink" href="#mrpro-algorithms-optimizers-cg" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mrpro.algorithms.optimizers.cg">
<span class="sig-prename descclassname"><span class="pre">mrpro.algorithms.optimizers.</span></span><span class="sig-name descname"><span class="pre">cg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mrpro.operators.RearrangeOp.LinearOperator.html#mrpro.operators.RearrangeOp.LinearOperator" title="mrpro.operators.LinearOperator.LinearOperator"><span class="pre">LinearOperator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_hand_side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mrpro.utils.slice_profiles.Tensor.html#mrpro.utils.slice_profiles.Tensor" title="torch.Tensor"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mrpro.utils.slice_profiles.Tensor.html#mrpro.utils.slice_profiles.Tensor" title="torch.Tensor"><span class="pre">Tensor</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mrpro.operators.EndomorphOperator.Callable.html#mrpro.operators.EndomorphOperator.Callable" title="collections.abc.Callable"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">CGStatus</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="mrpro.utils.slice_profiles.Tensor.html#mrpro.utils.slice_profiles.Tensor" title="torch.Tensor"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/mrpro/algorithms/optimizers/cg.html#cg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mrpro.algorithms.optimizers.cg" title="Link to this definition"></a></dt>
<dd><p>CG for solving a linear system <span class="math notranslate nohighlight">\(Hx=b\)</span>.</p>
<p>Thereby, <span class="math notranslate nohighlight">\(H\)</span> is a linear self-adjoint operator, <span class="math notranslate nohighlight">\(b\)</span> is the right-hand-side
of the system and <span class="math notranslate nohighlight">\(x\)</span> is the sought solution.</p>
<p>Note that this implementation allows for simultaneously solving a batch of <span class="math notranslate nohighlight">\(N\)</span> problems
of the form <span class="math notranslate nohighlight">\(H_i x_i = b_i\)</span> with <span class="math notranslate nohighlight">\(i=1,...,N\)</span>.</p>
<p>Thereby, the underlying assumption is that the considered problem is <span class="math notranslate nohighlight">\(Hx=b\)</span> with
<span class="math notranslate nohighlight">\(H:= diag(H_1, ..., H_N)\)</span> and  <span class="math notranslate nohighlight">\(b:= [b_1, ..., b_N]^T\)</span>.</p>
<p>Thus, if all <span class="math notranslate nohighlight">\(H_i\)</span> are self-adjoint, so is <span class="math notranslate nohighlight">\(H\)</span> and the CG can be applied.
Note however, that the accuracy of the obtained solutions might vary among the different
problems.
Note also that we don’t test if the input operator is self-adjoint or not.</p>
<p>Further, note that if the condition of <span class="math notranslate nohighlight">\(H\)</span> is very large, a small residual does not necessarily
imply that the solution is accurate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operator</strong> – self-adjoint operator (named H above)</p></li>
<li><p><strong>right_hand_side</strong> – right-hand-side of the system (named b above)</p></li>
<li><p><strong>initial_value</strong> – initial value of the algorithm; if None, it will be set to right_hand_side</p></li>
<li><p><strong>max_iterations</strong> – maximal number of iterations</p></li>
<li><p><strong>tolerance</strong> – tolerance for the residual; if set to zero, the maximal number of iterations
is the only stopping criterion used to stop the cg</p></li>
<li><p><strong>callback</strong> – function to be called at each iteration</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>an approximate solution of the linear system Hx=b</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mrpro.algorithms.optimizers.adam.html" class="btn btn-neutral float-left" title="mrpro.algorithms.optimizers.adam" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mrpro.algorithms.optimizers.lbfgs.html" class="btn btn-neutral float-right" title="mrpro.algorithms.optimizers.lbfgs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Physikalisch-Technische Bundesanstalt (PTB) Berlin.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>